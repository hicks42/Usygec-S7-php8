{% extends 'scpi/scpi_base.html.twig' %}

{% block title %}Produits
{% endblock title %}

{% block javascripts %}
	{{ parent() }}
	{{ importmap('scpi-compare') }}
{% endblock javascripts %}

{% block content %}
	<main role="main" class="max-w-screen-xl mx-auto px-5 py-10">

<div class="flex justify-center w-full">
		<div id="compare-popup" class="fixed top-0 bg-white flex flex-col justify-evenly items-center rounded-2xl border border-red-600 transition-transform duration-700 -translate-y-64 w-11/12 min-h-[18vh] opacity-0 shadow-2xl">
			<div id="compare-popupheader" class="fixed top-0 flex justify-center pt-1.5 bg-slate-900 text-white rounded-t-2xl text-base w-full mx-5">
				<button class="close-compare absolute top-0 right-0 p-2 rounded-bl-2xl rounded-tr-2xl border-0 bg-red-600 text-white font-bold cursor-pointer">x</button>
				<h5 class="m-0">Comparateur</h5>
			</div>
			<div class="compare-card-container mt-11 flex justify-around w-full">
				<div class="compare-card p-0 bg-gray-300 w-[32%] overflow-x-hidden rounded-b-lg border border-gray-400 my-1.5"></div>
				<div class="compare-card p-0 bg-gray-300 w-[32%] overflow-x-hidden rounded-b-lg border border-gray-400 my-1.5"></div>
				<div class="compare-card p-0 bg-gray-300 w-[32%] overflow-x-hidden rounded-b-lg border border-gray-400 my-1.5"></div>
			</div>
			<div class="flex justify-around w-1/2">
				<button class="razBtn border-0 flex justify-center items-center font-bold py-1.5 mb-2 rounded-lg w-52 text-white bg-red-400 no-underline align-middle transition-all hover:bg-red-500">
					<i class="fa-solid fa-delete-left mr-2"></i>Retirer le dernier</button>
				<button class="compareBtn flex justify-center items-center border-0 font-bold py-1.5 mb-2 rounded-lg w-52 text-white bg-green-700 no-underline align-middle transition-all hover:bg-green-300">
					<i class="fas fa-code-compare mr-2"></i>
					Comparez</button>
			</div>
		</div>
</div>
		<div class="pb-16">

			{% if produits|length > 0 %}
				{# <h1 class="bg-red-600 w-1/2 mx-auto mt-0 pt-6 pb-4 rounded-b-3xl text-white text-center text-4xl font-semibold">Produits</h1> #}
        <h1 class="bg-slate-900 w-6/12 m-0 pt-6 pb-4 rounded-md text-white text-center text-4xl font-semibold">Produits</h1>

				<div class="recherche my-4 px-8 py-4 border border-red-600 rounded-t-2xl bg-gray-200">
					{{ form_start(form) }}
					<div class="flex mb-3 gap-2">
						{{ form_widget(form.string, {'attr': {'class': 'flex-1 px-3 py-2 border border-gray-300 rounded'}}) }}
						<input class="px-4 py-2 bg-slate-700 text-white rounded cursor-pointer hover:bg-red-700 transition-colors" type="submit" value="Rechercher" formnovalidate>
					</div>
					{{ form_widget(form.categorie) }}
					{{ form_end(form) }}
				</div>

				{% for row in produits|batch(3) %}
					<div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-2">
						{% for produit in row %}
							<div>
								<article class="bg-white shadow-lg border-0 rounded-lg flex flex-col flex-nowrap my-4 mx-auto">
									<div class="max-h-24 rounded-t-lg overflow-hidden flex-grow max-w-full text-center">
										<a href=" {{ path('produit_show', {slug: produit.slug}) }} ">
											<img src="{{ (produit.imageName ? vich_uploader_asset(produit) : asset('images/scpi/placeholder.png')) | imagine_filter('rectangle_thumbnail_medium') }}" alt="{{ produit.name }}" class="h-24 max-w-full transition-transform duration-500 hover:scale-125"/>
										</a>
									</div>
									<div class="mx-2 my-0 mb-2 w-auto h-fit flex-grow-[2]">
										<h1 class="mt-4 text-base">
											<a href="{{ path('produit_show', {slug: produit.slug}) }}" class="text-gray-600 no-underline cursor-pointer hover:font-semibold">{{ produit.name }}</a>
										</h1>
										<p class="w-auto text-justify">
											<ul class="list-none p-0 m-0">
												<li>
													<small>Gérér par :
														{{ produit.socGest|u.truncate(25, ' ...', false)|raw }}</small>
												</li>
												<li>
													<small>Catégorie :
														{{ produit.categorie|u.truncate(25, ' ...', false)|raw }}</small>
												</li>
												<li>
													<small>Capital :
														{{ produit.capital|u.truncate(25, ' ...', false)|raw }}</small>
												</li>
												<li>
													<small>Thématique :
														{{ produit.thematique|u.truncate(25, ' ...', false)|raw }}</small>
												</li>
												<li>
													<small>Date de création :
														{{ produit.createdAt|date("d/m/Y") }}</small>
												</li>
												<li>
													<small>Capitalisation :
														{{ produit.Capitalisation }}
														Mds €</small>
												</li>
											</ul>
										</p>
										<p class="flex justify-around">
											{% set produitObj = {
											id: produit.id,
											name: produit.name,
											slug: produit.slug,
											SocGest: produit.socGest,
											categorie: produit.categorie.name,
											capital: produit.capital,
											capitalisation: produit.Capitalisation
											}
										%}
											<button class="select-produit px-4 py-2 bg-slate-900 text-white rounded w-1/2 cursor-pointer hover:bg-red-700 transition-colors my-6" data-produit-obj="{{ produitObj|json_encode|e('html_attr') }}">
												<i class="fa-solid fa-file-arrow-up mr-2"></i>Ajouter</button>
										</p>
									</div>
								</article>
							</div>
						{% endfor %}
					</div>
				{% endfor %}
			{% else %}
				<p class="text-4xl mt-12 text-center">Il n'y a pas de produits correspondant a votre Recherche</p>
				<p class="text-2xl mt-12 text-center">
					<a href="{{ path('scpi_hp') }}" class="inline-block px-4 py-2 bg-red-600 text-white rounded w-1/2 no-underline hover:bg-red-700 transition-colors">
						<i class="fa-solid fa-angles-left mr-2"></i>
						Retour a la homepage</a>
				</p>
			{% endif %}
		</div>
	</main>
{% endblock content %}
